<mvc:View
    controllerName="quality.controller.ResultRecording"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core">
    
    <Page title="Result Recording" showNavButton="true" navButtonPress="onNavBack" class="resultPage">
        
        <customHeader>
            <Bar class="resultHeader">
                <contentLeft>
                    <Button icon="sap-icon://nav-back" press="onNavBack"/>
                    <Title text="Result Recording" level="H2"/>
                </contentLeft>
                <contentRight>
                    <Button icon="sap-icon://test" press="onTestFetch" tooltip="Test Fetch"/>
                    <Button icon="sap-icon://refresh" press="onRefresh" tooltip="Refresh"/>
                </contentRight>
            </Bar>
        </customHeader>
        
        <content>
            <VBox class="resultContent">
                
                <!-- Selected Lot Information -->
                <f:Card class="lotInfoCard" visible="{= ${result>/selectedLot} !== null }">
                    <f:header>
                        <f:Header title="Inspection Lot Information"/>
                    </f:header>
                    <f:content>
                        <VBox class="lotInfoContent">
                            <HBox class="lotInfoGrid">
                                <VBox class="lotInfoItem">
                                    <Text text="Lot Number:" class="lotInfoLabel"/>
                                    <Text text="{result>/selectedLot/InspectionLotNumber}" class="lotInfoValue"/>
                                </VBox>
                                <VBox class="lotInfoItem">
                                    <Text text="Plant:" class="lotInfoLabel"/>
                                    <Text text="{result>/selectedLot/Plant} - {result>/selectedLot/PlantDescription}" class="lotInfoValue"/>
                                </VBox>
                                <VBox class="lotInfoItem">
                                    <Text text="Material:" class="lotInfoLabel"/>
                                    <Text text="{result>/selectedLot/SelectedMaterial}" class="lotInfoValue"/>
                                </VBox>
                                <VBox class="lotInfoItem">
                                    <Text text="Actual Quantity:" class="lotInfoLabel"/>
                                    <Text text="{result>/selectedLot/ActualQuantity} {result>/selectedLot/UnitOfMeasure}" class="lotInfoValue"/>
                                </VBox>
                                <VBox class="lotInfoItem">
                                    <Text text="Inspected Quantity:" class="lotInfoLabel"/>
                                    <Text text="{result>/selectedLot/InspectedQuantity} {result>/selectedLot/UnitOfMeasure}" class="lotInfoValue"/>
                                </VBox>
                                <VBox class="lotInfoItem">
                                    <Text text="Status:" class="lotInfoLabel"/>
                                    <ObjectStatus text="{result>/selectedLot/UsageDecisionStatus}" state="{result>/selectedLot/StatusState}"/>
                                </VBox>
                            </HBox>
                        </VBox>
                    </f:content>
                </f:Card>
                
                <!-- Result Recording Form -->
                <f:Card class="resultFormCard">
                    <f:header>
                        <f:Header title="Record New Result"/>
                    </f:header>
                    <f:content>
                        <VBox class="resultFormContent">
                            
                            <HBox class="resultFormGrid">
                                <VBox>
                                    <Label text="Inspection Lot Number:" required="true"/>
                                    <Input value="{result>/newResult/InspectionLotNumber}" placeholder="Enter lot number"/>
                                </VBox>
                                <VBox>
                                    <Label text="Plant Code:" required="true"/>
                                    <Input value="{result>/newResult/PlantCode}" placeholder="Enter plant code"/>
                                </VBox>
                                <VBox>
                                    <Label text="Inspector Name:"/>
                                    <Input value="{result>/newResult/InspectorName}" placeholder="Enter inspector name"/>
                                </VBox>
                            </HBox>
                            
                            <HBox class="resultFormGrid">
                                <VBox>
                                    <Label text="Recorded Date:"/>
                                    <DatePicker value="{result>/newResult/RecordedDate}"/>
                                </VBox>
                                <VBox>
                                    <Label text="Usage Decision Code:"/>
                                    <Select selectedKey="{result>/newResult/UsageDecisionCode}">
                                        <core:Item key="" text="Select Decision"/>
                                        <core:Item key="A" text="Approved (A)"/>
                                        <core:Item key="R" text="Rejected (R)"/>
                                        <core:Item key="R2" text="Rework Required (R2)"/>
                                    </Select>
                                </VBox>
                                <VBox>
                                    <Label text="Stock Code:"/>
                                    <Select selectedKey="{result>/newResult/StockCode}">
                                        <core:Item key="" text="Select Stock Code"/>
                                        <core:Item key="100" text="100 - Unrestricted"/>
                                        <core:Item key="1" text="1 - Blocked"/>
                                        <core:Item key="20" text="20 - Production"/>
                                    </Select>
                                </VBox>
                            </HBox>
                            
                            <HBox class="resultFormGrid">
                                <VBox>
                                    <Label text="Result Category:"/>
                                    <Select selectedKey="{result>/newResult/ResultCategory}">
                                        <core:Item key="" text="Select Category"/>
                                        <core:Item key="Unrestricted Stock" text="Unrestricted Stock"/>
                                        <core:Item key="Block Stock" text="Block Stock"/>
                                        <core:Item key="Production Stock" text="Production Stock"/>
                                    </Select>
                                </VBox>
                                <VBox>
                                    <Label text="Recording Status:"/>
                                    <Select selectedKey="{result>/newResult/RecordingStatus}">
                                        <core:Item key="Active" text="Active"/>
                                        <core:Item key="View Only" text="View Only"/>
                                    </Select>
                                </VBox>
                            </HBox>
                            
                            <HBox class="resultFormButtons">
                                <Button text="Clear Form" press="onClearForm" type="Transparent"/>
                                <Button text="Save Result" press="onSaveResult" type="Emphasized"/>
                            </HBox>
                            
                        </VBox>
                    </f:content>
                </f:Card>
                
                <!-- Existing Results Table -->
                <f:Card class="resultsTableCard">
                    <f:header>
                        <f:Header title="Existing Results"/>
                    </f:header>
                    <f:content>
                        <Table 
                            items="{result>/results}"
                            growing="true"
                            growingThreshold="20"
                            busy="{result>/isLoading}">
                            
                            <columns>
                                <Column>
                                    <Text text="Lot Number"/>
                                </Column>
                                <Column>
                                    <Text text="Plant"/>
                                </Column>
                                <Column>
                                    <Text text="Inspector"/>
                                </Column>
                                <Column>
                                    <Text text="Recorded Date"/>
                                </Column>
                                <Column>
                                    <Text text="Decision Code"/>
                                </Column>
                                <Column>
                                    <Text text="Stock Code"/>
                                </Column>
                                <Column>
                                    <Text text="Category"/>
                                </Column>
                                <Column>
                                    <Text text="Status"/>
                                </Column>
                            </columns>
                            
                            <items>
                                <ColumnListItem>
                                    <cells>
                                        <Text text="{result>InspectionLotNumber}" class="lotNumber"/>
                                        <Text text="{result>PlantCode}"/>
                                        <Text text="{result>InspectorName}"/>
                                        <Text text="{result>RecordedDateFormatted}"/>
                                        <Text text="{result>UsageDecisionCode}"/>
                                        <Text text="{result>StockCode}"/>
                                        <Text text="{result>ResultCategory}"/>
                                        <ObjectStatus 
                                            text="{result>RecordingStatus}"
                                            state="{result>StatusState}"/>
                                    </cells>
                                </ColumnListItem>
                            </items>
                            
                        </Table>
                    </f:content>
                </f:Card>
                
            </VBox>
        </content>
        
    </Page>
    
</mvc:View>