<mvc:View
    controllerName="quality.controller.Dashboard"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core">
    
    <Page title="Quality Management Dashboard" showNavButton="false" class="dashboardPage">
        
        <customHeader>
            <Bar class="dashboardHeader">
                <contentLeft>
                    <Title text="QMS Dashboard" level="H2"/>
                </contentLeft>
                <contentRight>
                    <Button icon="sap-icon://refresh" press="onRefresh" tooltip="Refresh Data"/>
                    <Button icon="sap-icon://test" press="onTestServices" tooltip="Test Services"/>
                    <Button icon="sap-icon://log" press="onLogout" tooltip="Logout"/>
                </contentRight>
            </Bar>
        </customHeader>
        
        <content>
            <VBox class="dashboardContent">
                
                <!-- Statistics Cards -->
                <HBox class="statsContainer" justifyContent="SpaceAround">
                    
                    <f:Card class="statsCard inspectionCard">
                        <f:header>
                            <f:Header title="Total Inspections"/>
                        </f:header>
                        <f:content>
                            <VBox alignItems="Center" class="cardContent">
                                <Text text="{dashboard>/counts/totalInspections}" class="statsNumber"/>
                                <Text text="Inspection Lots" class="statsLabel"/>
                                <Button text="View All" type="Transparent" press="onNavigateToResults"/>
                            </VBox>
                        </f:content>
                    </f:Card>
                    
                    <f:Card class="statsCard pendingCard">
                        <f:header>
                            <f:Header title="Pending Inspections"/>
                        </f:header>
                        <f:content>
                            <VBox alignItems="Center" class="cardContent">
                                <Text text="{dashboard>/counts/pendingInspections}" class="statsNumber"/>
                                <Text text="Awaiting Decision" class="statsLabel"/>
                                <Button text="Process" type="Emphasized" press="onNavigateToResults"/>
                            </VBox>
                        </f:content>
                    </f:Card>
                    
                    <f:Card class="statsCard completedCard">
                        <f:header>
                            <f:Header title="Completed"/>
                        </f:header>
                        <f:content>
                            <VBox alignItems="Center" class="cardContent">
                                <Text text="{dashboard>/counts/completedInspections}" class="statsNumber"/>
                                <Text text="Decisions Made" class="statsLabel"/>
                                <Button text="Review" type="Transparent" press="onNavigateToUsage"/>
                            </VBox>
                        </f:content>
                    </f:Card>
                    
                    <f:Card class="statsCard resultsCard">
                        <f:header>
                            <f:Header title="Results Recorded"/>
                        </f:header>
                        <f:content>
                            <VBox alignItems="Center" class="cardContent">
                                <Text text="{dashboard>/counts/totalResults}" class="statsNumber"/>
                                <Text text="Result Records" class="statsLabel"/>
                                <Button text="View" type="Transparent" press="onNavigateToResults"/>
                            </VBox>
                        </f:content>
                    </f:Card>
                    
                </HBox>
                
                <!-- Quick Actions -->
                <Panel headerText="Quick Actions" class="actionsPanel">
                    <content>
                        <HBox class="actionButtons" justifyContent="SpaceAround">
                            <Button 
                                text="Record Results" 
                                icon="sap-icon://add-document"
                                type="Emphasized"
                                press="onNavigateToResults"
                                class="actionButton"/>
                            <Button 
                                text="Usage Decisions" 
                                icon="sap-icon://decision"
                                type="Default"
                                press="onNavigateToUsage"
                                class="actionButton"/>
                            <Button 
                                text="Test Services" 
                                icon="sap-icon://test"
                                type="Transparent"
                                press="onTestServices"
                                class="actionButton"/>
                        </HBox>
                    </content>
                </Panel>
                
                <!-- Inspection Lots Table -->
                <Panel headerText="Recent Inspection Lots" class="lotsPanel">
                    <content>
                        <Table 
                            items="{dashboard>/inspectionLots}"
                            growing="true"
                            growingThreshold="20"
                            class="inspectionTable">
                            
                            <columns>
                                <Column>
                                    <Text text="Lot Number"/>
                                </Column>
                                <Column>
                                    <Text text="Plant"/>
                                </Column>
                                <Column>
                                    <Text text="Material"/>
                                </Column>
                                <Column>
                                    <Text text="Quantities"/>
                                </Column>
                                <Column>
                                    <Text text="Progress"/>
                                </Column>
                                <Column>
                                    <Text text="Status"/>
                                </Column>
                                <Column>
                                    <Text text="Actions"/>
                                </Column>
                            </columns>
                            
                            <items>
                                <ColumnListItem press="onInspectionLotPress" type="Active">
                                    <cells>
                                        <Text text="{dashboard>InspectionLotNumber}" class="lotNumber"/>
                                        <VBox>
                                            <Text text="{dashboard>Plant}"/>
                                            <Text text="{dashboard>PlantDescription}" class="plantDesc"/>
                                        </VBox>
                                        <Text text="{dashboard>SelectedMaterial}"/>
                                        <VBox>
                                            <Text text="Actual: {dashboard>ActualQuantity} {dashboard>UnitOfMeasure}"/>
                                            <Text text="Inspected: {dashboard>InspectedQuantity} {dashboard>UnitOfMeasure}"/>
                                        </VBox>
                                        <ProgressIndicator 
                                            percentValue="{dashboard>ProgressPercent}"
                                            displayValue="{dashboard>ProgressPercent}%"
                                            class="progressBar"/>
                                        <ObjectStatus 
                                            text="{dashboard>StatusText}"
                                            state="{dashboard>StatusState}"/>
                                        <Button 
                                            text="Process" 
                                            type="Emphasized"
                                            press="onInspectionLotPress"
                                            visible="{= ${dashboard>UsageDecisionStatus} === 'Pending' }"/>
                                    </cells>
                                </ColumnListItem>
                            </items>
                            
                        </Table>
                    </content>
                </Panel>
                
                <!-- Loading Indicator -->
                <BusyIndicator visible="{dashboard>/isLoading}" class="loadingIndicator"/>
                
                <!-- Last Updated -->
                <Text 
                    text="Last Updated: {dashboard>/lastUpdated}" 
                    class="lastUpdated"
                    visible="{= ${dashboard>/lastUpdated} !== null }"/>
                
            </VBox>
        </content>
        
    </Page>
    
</mvc:View>